resources:
  methods:
    Flowpack_Snippets_Login: 'method(TYPO3\Flow\Security\Authentication\Controller\AbstractAuthenticationController->(?<!initialize).*Action()) || method(Flowpack\Snippets\Controller\LoginController->(index|authenticate)Action())'
    Flowpack_Snippets_Search: 'method(Flowpack\Snippets\Controller\SearchController->(search|searchCategory|searchTag|searchAuthor)Action())'
    Flowpack_Snippets_Post: 'method(Flowpack\Snippets\Controller\PostController->(new|show|index)Action())'
    Flowpack_Snippets_PostActions: 'method(Flowpack\Snippets\Controller\PostController->(create|voteUp|voteDown|favor)Action())'
    Flowpack_Snippets_PostUpdateActions: 'method(Flowpack\Snippets\Controller\PostController->(edit|update|delete)Action(post.author == current.securityContext.party))'
    Flowpack_Snippets_CommentActions: 'method(Flowpack\Snippets\Controller\CommentController->(create)Action())'
    Flowpack_Snippets_CommentUpdateActions: 'method(Flowpack\Snippets\Controller\CommentController->(delete)Action(comment.author == current.securityContext.party))'
    Flowpack_Snippets_Backend_Module_Snippets: 'method(Flowpack\Snippets\Controller\Module\SnippetsController->indexAction())'
    Flowpack_Snippets_Backend_Module_Snippets_Posts: 'method(Flowpack\Snippets\Controller\Module\Snippets\PostsController->(activate|deactivate|index|show|delete|edit|update)Action())'
    Flowpack_Snippets_Backend_Module_Snippets_Categories: 'method(Flowpack\Snippets\Controller\Module\Snippets\CategoriesController->(index|new|create|edit|update|delete|show)Action())'
    Flowpack_Snippets_Backend_Module_Snippets_Tags: 'method(Flowpack\Snippets\Controller\Module\Snippets\TagsController->(index|new|create|edit|update|delete|show)Action())'

roles:
  User: []

acls:
  Everybody:
    methods:
      # we need to explicitly allow access to the public actions because by default all actions are denied by the Neos policies
      Flowpack_Snippets_Search: GRANT
      Flowpack_Snippets_Login: GRANT
      Flowpack_Snippets_Post: GRANT
  'Flowpack.Snippets:User':
    methods:
      Flowpack_Snippets_PostActions: GRANT
      Flowpack_Snippets_PostUpdateActions: GRANT
      Flowpack_Snippets_CommentActions: GRANT
      Flowpack_Snippets_CommentUpdateActions: GRANT
  'TYPO3.Neos:Administrator':
    methods:
      Flowpack_Snippets_Backend_Module_Snippets: GRANT
      Flowpack_Snippets_Backend_Module_Snippets_Categories: GRANT
      Flowpack_Snippets_Backend_Module_Snippets_Posts: GRANT
      Flowpack_Snippets_Backend_Module_Snippets_Tags: GRANT