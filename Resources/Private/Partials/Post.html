{namespace snippets=Flowpack\Snippets\ViewHelpers}
<article>
    <div class="row">
        <div class="small-12 columns">
            <h3>
                <f:if condition="{post.url}">
                    <f:then>
                        <f:link.external uri="{post.url}" target="_blank">{post.title}</f:link.external>
                    </f:then>
                    <f:else>
                        <f:link.action action="show" controller="post" arguments="{post: post}">{post.title}</f:link.action>
                    </f:else>
                </f:if>
            </h3>
        </div>
    </div>

    <div class="row">
        <div class="small-12 columns">
            <h6>
                <f:form action="search" name="search" method="POST" class="filter author">
                    <f:form.hidden property="filter.author" value="{post.author.name.alias -> snippets:strtolower()}" />
                    <i class="fa fa-user fa-fw"></i><f:form.button class="link"> {post.author.name.alias}</f:form.button>
                </f:form>
                <i class="fa fa-calendar fa-fw"></i><f:format.date format="d.m.Y">{post.date}</f:format.date>
            </h6>
        </div>
    </div>

    <f:if condition="{post.description}">
        <div class="row">
            <div class="small-12 columns">
                <p>{post.description}</p>
            </div>
        </div>
    </f:if>

    <f:if condition="{post.url}">
        <div class="row">
            <div class="small-12 columns">
                <div class="panel radius">
                    Originally Posted on <f:link.external uri="{post.providerUrl}" target="_blank"><img src="{post.providerIcon}" /> {post.providerName}</f:link.external><br /><br />
                    <f:link.external uri="{post.url}" target="_blank"><i class="fa fa-external-link-square"></i> {post.url}</f:link.external><br /><br />
                    <f:if condition="{post.code}">
                        <f:if condition="{post.code -> snippets:strpos(needle: 'iframe')}">
                            <a href="#" data-reveal-id="Modal-{identifier}" class="label">Preview</a>
                            <div id="Modal-{identifier}" class="reveal-modal small" data-reveal>
                                <h2>{post.title}</h2>
                                <div class="flex-video">
                                    <f:format.raw>{post.code}</f:format.raw>
                                </div>
                                <a class="close-reveal-modal">&#215;</a>
                            </div>
                        </f:if>
                    </f:if>
                </div>
            </div>
        </div>
    </f:if>

    <div class="row">
        <div class="small-12 columns">
            <f:form action="search" name="search" method="POST" class="filter category">
                <f:form.hidden property="filter.category" id="category" value="{post.category.name -> snippets:strtolower()}" />
                <i class="fa fa-folder-open fa-fw"></i><f:form.button class="link"> {post.category.name}</f:form.button>
            </f:form>
            <f:if condition="{post.content}"> | {post.views} views | <i class="fa fa-chevron-up"></i> <i class="fa fa-chevron-down"></i></f:if>
        </div>
    </div>

    <div class="row">
        <div class="small-12 columns">
            <f:for each="{post.tags}" as="tag">
                <f:form action="search" name="search" method="POST" class="filter tag">
                    <f:form.hidden property="filter.tags" id="category" value="{tag.name -> snippets:strtolower()}" />
                    <f:form.button class="secondary radius label">{tag.name}</f:form.button>
                </f:form>
            </f:for>
        </div>
    </div>
</article>
